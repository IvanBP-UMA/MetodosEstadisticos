library(tidyverse)
data <- tibble(x=c(1, 2, 3, 4, 5), y1 = c(4, 2, 3, 2, 4), y2=c(1, 3, 5, 7, 9))
data
covXY1 <- mean(data$x*data$y1) - mean(data$x)*mean(data$y1)
covXY1
cov(data$x, data$y1)
lm(y1, x, data)
dat <- tibble(x=c(1, 2, 3, 4, 5), y1=c(4, 2, 3, 2, 4), y2=c(1, 3, 5, 7, 9))
covXY1 <- mean(dat$x*dat$y1) - mean(dat$x)*mean(dat$y1)
lm(y1~x, dat)
lm(y2~x, dat)
mean(dat$y2)
cov(dat$x, dat$y2)
covXY2 <- mean(dat$x*dat$y2) - mean(dat$x)*mean(dat$y2)
covXY2
#Ejercicio 4
dat <- tibble(x=c(43, 55, 40, 52, 39, 33, 50, 33, 44, 21), y=c(27, 23.8, 30.7, 24, 34.8, 41.4, 27, 40.4, 31.7, 51.2))
dat
mod <- lm(y~x, dat)
summary(mod)
summary(mod)$r.squared
sqrt(summary(mod)$r.squared)
covXY <- mean(dat$x*dat$y) - mean(dat$x)*mean(dat$y)
covXY
varX <- mean(dat$x^2) - mean(dat$x)^2
covXY
varX
varY <- mean(dat$y^2) - mean(dar$y)^2
varY <- mean(dat$y^2) - mean(dat$y)^2
varY
names(mod)
names(summary(mods))
names(summary(mod))
y <- c(3, 4.5, 7, 10, 15)
x <- c(1, 2, 3, 4, 5)
z <- log(y)
mod1 <- lm(z~x)
yEst <- predict.lm(mod1)
MSE <- mean((y - yEst)^2)
varY <- mean(y^2) - mean(y)^2
rSQRD <- 1 - MSE/varY
rSQRD
x <- c(1, 2, 3, 4, 5)
y <- c(3, 4.5, 7, 10, 15)
z <- log(y)
mod2  <- lm(z~x)
# OJO: Este valor no es el que hay que utilizar. Es el R2 de z. NO nos vale
summary(mod2)$r.squared
yp2 <- coef2[1] * coef2[2] ^ x
# y predichas por el modelo 2
exp(predict.lm(mod2))
yEst <- exp(predict.lm(mod1))
MSE <- mean((y - yEst)^2)
varY <- mean(y^2) - mean(y)^2
rSQRD <- 1 - MSE/varY
rSQRD
MSE2 <- mean((y - yp2)^2)
varY <- mean(y^2) - mean(y)^2
coef2 <- exp(mod2$coefficients)
yp2 <- coef2[1] * coef2[2] ^ x
MSE2 <- mean((y - yp2)^2)
varY <- mean(y^2) - mean(y)^2
R2_2 <- 1 - MSE2/varY
R2_2
# OJO: Este valor no es el que hay que utilizar. Es el R2 de z. NO nos vale
summary(mod2)$r.squared
summary(mod1)$r.squared
